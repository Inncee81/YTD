<html>
<head>
<title>KOL Help: TDirList object (main frame)</title>
<base target="_top">
</head>

<body bgcolor="#FFFFEF" text="#000000" link="#008080" vlink="#008000" alink="#808000">
<p><font face="Courier" color="#800080"><b>TDirList( unit <a href=kol_pas.htm>KOL.pas</a> )
 <font face="Wingdings">ï</font> <a href=tobj.htm>TObj</a>
 <font face="Wingdings">ï</font> <a href=_tobj.htm>_TObj</a>
</b></font></p>
<p><b>
TDirList = object( <a href=tobj.htm target="_top">TObj</a> )
</b></p>
Allows easy directory scanning. This is not visual object, but
storage to simplify working with directory content.
<h3 align="center"><font color="#FF8080">TDirList properties</font></h3>
<a name="items"></a>
<p>
<font face="Courier" color="#800080"><b>property</b> <font color="#808000"><b>Items</b></font>[ Idx: <b>Integer</b> ]: PFindfileData; <b>default</b>;</font>
&nbsp;&nbsp;&nbsp;<font face="Webdings" size=7>&#209;</font>&nbsp;&nbsp;&nbsp;
<br>
Full access to scanned items (files and subdirectories).
</p>
<a name="isdirectory"></a>
<p>
<font face="Courier" color="#800080"><b>property</b> <font color="#808000"><b>IsDirectory</b></font>[ Idx: <b>Integer</b> ]: <b>Boolean</b>;</font>
&nbsp;&nbsp;&nbsp;<font face="Webdings" size=7>&#209;</font>&nbsp;&nbsp;&nbsp;
<br>
Returns TRUE, if specified item represents a directory, not a file.
</p>
<a name="count"></a>
<p>
<font face="Courier" color="#800080"><b>property</b> <font color="#808000"><b>Count</b></font>: <b>Integer</b>;</font>
&nbsp;&nbsp;&nbsp;<font face="Webdings" size=7>&#209;</font>&nbsp;&nbsp;&nbsp;
<br>
Number of items.
</p>
<a name="names"></a>
<p>
<font face="Courier" color="#800080"><b>property</b> <font color="#808000"><b>Names</b></font>[ Idx: <b>Integer</b> ]: KOLString;</font>
&nbsp;&nbsp;&nbsp;<font face="Webdings" size=7>&#209;</font>&nbsp;&nbsp;&nbsp;
<br>
Full long names of directory items.
</p>
<a name="path"></a>
<p>
<font face="Courier" color="#800080"><b>property</b> <font color="#808000"><b>Path</b></font>: KOLString;</font>
&nbsp;&nbsp;&nbsp;<font face="Webdings" size=7>&#209;</font>&nbsp;&nbsp;&nbsp;
<br>
Path of scanned directory.
</p>
<h4 align="center"><font color="black">Properties, inherited from <a href="tobj.htm" target="_top">TObj</a></font></h4>
<h3 align="center"><font color="#FF8080">TDirList methods</font></h3>
<a name="destroy"></a>
<p>
<font face="Courier" color="#800080"><b>destructor</b> <font color="#808000"><b>Destroy</b></font>; <b>virtual</b>;</font>
&nbsp;&nbsp;&nbsp;<font face="Webdings" size=7>&#78;</font>&nbsp;&nbsp;&nbsp;
<br>
Destructor. As usual, call <a href=#free target="main">Free</a> method to destroy an object.
</p>
<a name="clear"></a>
<p>
<font face="Courier" color="#800080"><b>procedure</b> <font color="#808000"><b>Clear</b></font>;</font>
<br>
Call it to clear list of files.
</p>
<a name="scandirectory"></a>
<p>
<font face="Courier" color="#800080"><b>procedure</b> <font color="#808000"><b>ScanDirectory</b></font>( <b>const</b> DirPath, Filter: KOLString; Attr: <b>DWord</b> );</font>
<br>
Call it to rescan directory or to scan another directory content
(method <a href=#clear target="main">Clear</a> is called first). Pass path to directory, file filter
and attributes to scan directory immediately.
<br>&nbsp;&nbsp;&nbsp;
Note: Pass FILE_ATTRIBUTE_... constants or-combination as Attr
parameter. If 0 passed, both files and directories are listed.
</p>
<a name="scandirectoryex"></a>
<p>
<font face="Courier" color="#800080"><b>procedure</b> <font color="#808000"><b>ScanDirectoryEx</b></font>( <b>const</b> DirPath, Filters: KOLString; Attr: <b>DWord</b> );</font>
<br>
Call it to rescan directory or to scan another directory content
(method <a href=#clear target="main">Clear</a> is called first). Pass path to directory, file filter
and attributes to scan directory immediately.
<br>&nbsp;&nbsp;&nbsp;
Note: Pass FILE_ATTRIBUTE_... constants or-combination as Attr
parameter.
</p>
<a name="sort"></a>
<p>
<font face="Courier" color="#800080"><b>procedure</b> <font color="#808000"><b>Sort</b></font>( Rules: <b>array</b> <b>of</b> <a href=kol_pas.htm#tsortdirrules target="_top">TSortDirRules</a> );</font>
<br>
Sorts directory entries. If empty rules array passed, default rules
array <a href=kol_pas.htm#defsortdirrules target="_top">DefSortDirRules</a> is used.
</p>
<a name="filelist"></a>
<p>
<font face="Courier" color="#800080"><b>function</b> <font color="#808000"><b>FileList</b></font>( <b>const</b> Separator: KOLString; Dirs, FullPaths: <b>Boolean</b> ): KOLString;</font>
<br>
Returns a string containing all names separated with Separator.
If Dirs=FALSE, only files are returned.
</p>
<h4 align="center"><font color="black">Methods, inherited from <a href="tobj.htm" target="_top">TObj</a></font></h4>
<h3 align="center"><font color="#FF8080">TDirList events</font></h3>
<a name="onitem"></a>
<p>
<font face="Courier" color="#800080"><b>property</b> <font color="#808000"><b>OnItem</b></font>: TOnDirItem;</font>
<br>
This event is called on reading each item while scanning directory.
To use it, first create PDirList object with empty path to scan, then
assign OnItem event and call <a href=#scandirectory target="main">ScanDirectory</a> with correct path.
</p>
<h4 align="center"><font color="black">Events, inherited from <a href="tobj.htm" target="_top">TObj</a></font></h4>
<h3 align="center"><font color="#FF8080">TDirList fields</font></h3>
<h4 align="center"><font color="black">Fields, inherited from <a href="tobj.htm" target="_top">TObj</a></font></h4>
<hr>
<p align="center">[&nbsp;<a href=index.htm>Index</a>&nbsp;]</p>
<p align="center"><font face="Comic Sans MS"><small>This help is generated 14-Jun-2010 by KOL Help generator, (C) 2000-2001 by Vladimir Kladov<br>Modified (C) 2003 by Alexander Bartov</small></font></p>
</body>
</html>
